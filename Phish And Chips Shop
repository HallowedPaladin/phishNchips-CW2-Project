# def add_stock(item_name,amount):
#     for item in inventory:
#         if item["name"]==item_name:
#             item["quantity"] += amount
#             print(f{amount} added to {item_name}). New quantity: {item["quantity"]}
#             return
#     print("item not found")

def adding_stock(item_name,pricing,item_category,stock_quantity):
    item_name = input("please input the name of the stock you wish to add: ")
    pricing = float(input("please input the price: "))
    item_category =input("please input the category: ")
    stock_quantity =int(input("please input the quantity: "))
    inventory.append({
    "name": stock_name,
    "price": price,
    "category": category,
    "quantity": quantity,
    })


inventory.append({
"name": stock_name,
"price": price,
"category": category,
"quantity": quantity,
})

    

# Function to print tables using the standard library only
def print_table_std_lib(headers, data):
    if not data: return
    col_widths = [len(h) for h in headers]
    for row in data:
        for i, cell in enumerate(row):
            if len(str(cell)) > col_widths[i]: 
                col_widths[i] = len(str(cell))
    col_widths = [w + 2 for w in col_widths] 
    format_string = "| " + " | ".join([f"{{:<{w}}}" for w in col_widths]) + " |" 
    separator = "-" * (sum(col_widths) + (len(col_widths) * 3) + 1) 
    print(separator)
    print(format_string.format(*headers))
    print(separator)
    for row in data:
        print(format_string.format(*[str(c) for c in row]))
    print(separator)

# View inventory function to display all the items
def view_inventory(inventory):
    print("\n-- Current Inventory --")
    # Preparing the data for printing
    headers = ["ID", "Name", "Price (£)", "Quantity", "Category"]
    table_data = []
    for item in inventory:
        table_data.append([
            item['id'],
            item['name'],
            f"{item['price']:.2f}",
            item['quantity'],
            item['category']
        ])
    
    print_table_std_lib(headers, table_data)


# My version of the update inventory function, if you wanna change it to make it better then go ahead :)
def update_inventory(inventory):
    item_id = input("Enter the item ID to update: ").upper()

    for item in inventory:
        if item["id"] == item_id:
            print("\nLeave blank to keep the current value.")

            new_name = input(f'New name ({item["name"]}): ')
            new_price = input(f'New price (£{item["price"]}): ')
            new_quantity = input(f'New quantity ({item["quantity"]}): ')
            new_category = input(f'New category ({item["category"]}): ')

            if new_name != "":
                item["name"] = new_name

            if new_price != "":
                try:
                    item["price"] = float(new_price)
                except ValueError:
                    print("Invalid price. Price not updated.")

            if new_quantity != "":
                try:
                    item["quantity"] = int(new_quantity)
                except ValueError:
                    print("Invalid quantity. Quantity not updated.")

            if new_category != "":
                item["category"] = new_category.lower()

            print("\nItem updated successfully.")
            return

    print("\nItem ID not found.")

# My attempt at the low stock check extension task, if you wanna improve it then feel free :)
def low_stock_check(inventory):
    print("\nLow stock items (quantity below 6):")
    print("-" * 40)

    found = False

    for item in inventory:
        if item["quantity"] < 6:
            print(f'{item["id"]} | {item["name"]} | Qty: {item["quantity"]} | LOW STOCK')
            found = True

    if not found:
        print("No items are currently low in stock.")


import json #Importing json
fileName = "inventory.json"
exit = False

def search(inventory):
    found = False
    #This will read the file and save load it as the variable items
    with open("inventory.json","r") as file:
        items = json.load(file)

    #This will ask the user to enter what they wish to search by
    search_by = input("What would you like to search by: ID, Name, Price, Quantity: ")

    #If id is entered this code will run
    if search_by.lower() == "id":
        id = int(input("Enter the ID of an item: "))
        for item in items:
            if item["id"] == id:
                found = True
                price = item["price"]
                print("Item found, detials below:")
                print(f"ID: {item["id"]} Name: {item["name"]} Price: £{price:.2f} Quantity: {item["quantity"]}")

    #If name is entered this code will run
    elif search_by.lower() == "name":
        name = input("Enter the name of an item: ")
        for item in items:
            if item["name"] == name.lower():
                found = True
                price = item["price"]
                print("Item found, detials below:")
                print(f"ID: {item["id"]} Name: {item["name"]} Price: £{price:.2f} Quantity: {item["quantity"]}")

    #If price is entered this code will run
    elif search_by.lower() == "price":
        price = float(input("Enter the price of an item: "))
        for item in items:
            if item["price"] == price:
                found = True
                price = item["price"]
                print("Item found, detials below:")
                print(f"ID: {item["id"]} Name: {item["name"]} Price: £{price:.2f} Quantity: {item["quantity"]}")

    #If quantity is entered this code will run
    elif search_by.lower() == "quantity":
        quantity = int(input("Enter the quantity of an item: "))
        for item in items:
            if item["quantity"] == quantity:
                found = True
                price = item["price"]
                print("Item found, detials below:")
                print(f"ID: {item["id"]} Name: {item["name"]} Price: £{price:.2f} Quantity: {item["quantity"]}")

    #If an invalid input is entered this code will run
    else:
        print("Invalid input")

    #If the item is not found it will inform the user
    if found == False:
        print("Item not found")

#This is a while loop that will continue to ask the user what changes they wish to make to the inventory file until they type in Exit
while exit == False:
    #This is an input variable that will ask the user to enter an action and will direct them to the correct if statement
    action = input("Which of the following would you like to do: Add Item, View Stock, Update Item, Search, Exit: ")

    #If the user enters add item, this code will run
    if action.lower() == "add item":
        print("Add Item")

    #If the user enters view stock, this code will run
    elif action.lower() == "view stock":
        view_inventory(fileName)

    #If the user enters update stock, this code will run
    elif action.lower() == "update item":
         update_inventory(fileName)
         low_stock_check(fileName)

    #If the user enters search, this code will run
    elif action.lower() == "search":
        search(fileName)

    #If the user enters exit, this code will run
    elif action.lower() == "exit":
        print("Your changes have been saved. Have a nice day!")
        exit = True

    #If the user enteres an invalid input this code will run
    else:
        print("Invalid input")



